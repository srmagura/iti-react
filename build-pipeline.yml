trigger:
  batch: true
  branches:
    include:
      - main

pool:
  vmImage: 'ubuntu-latest'

steps:
  - task: Cache@2
    displayName: Restore yarn cache
    inputs:
      key: 'yarn | "$(Agent.OS)" | yarn.lock'
      path: .yarn/cache

  - pwsh: yarn install --immutable
    displayName: yarn install

  - pwsh: yarn build-all
    displayName: Build

  - pwsh: yarn test-all
    displayName: Run tests

  - pwsh: yarn lint-all
    displayName: Run ESLint
